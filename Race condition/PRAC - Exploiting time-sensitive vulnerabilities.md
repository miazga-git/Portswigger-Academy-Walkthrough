Title: Exploiting time-sensitive vulnerabilities
Level: PRACTITIONER
Desc:  This lab contains a password reset mechanism. Although it doesn't contain a race condition, you can exploit the mechanism's broken cryptography by sending carefully timed requests.
To solve the lab:

    Identify the vulnerability in the way the website generates password reset tokens.
    Obtain a valid password reset token for the user carlos.
    Log in as carlos.
    Access the admin panel and delete the user carlos.

You can log into your account with the following credentials: wiener:peter. 


# Walkthrough

Problem, that I couldn't resolve was to find a way how to make those requests to be run in the same time. I found in solution, that in PHP server process one request in a time per session. 
I know, that attacked server is php by session cookie.
![image](https://github.com/user-attachments/assets/047903a1-2030-4f29-9ce7-f041662abaa4)

```
Bypass the per-session locking restriction

    Notice that your session cookie suggests that the website uses a PHP back-end. This could mean that the server only processes one request at a time per session.

    Send the GET /forgot-password request to Burp Repeater, remove the session cookie from the request, then send it.

    From the response, copy the newly issued session cookie and CSRF token and use them to replace the respective values in one of the two POST /forgot-password requests. You now have a pair of password reset requests from two different sessions.

    Send the two POST requests in parallel a few times and observe that the processing times are now much more closely aligned, and sometimes identical.
```
Generating second session by sending request to forget-password.

![image](https://github.com/user-attachments/assets/d6efa4a2-58d0-4f53-ab12-d756643eedeb)


Now I can try to send 2 requests for user wiener, but in the same time. I use different csrf tokens, different sessions cookies and makes those requests by parallel method. I managed to get 2 emails for chaning password, but with the same code: 

![image](https://github.com/user-attachments/assets/37ecc59b-7534-4f9e-ae8f-1d96e37fe593)


Now I can make the same trick but one request for user carlos and one for user wiener: 
![image](https://github.com/user-attachments/assets/2b50b88a-b3c0-49e7-a6be-f911abe3a77f)

![image](https://github.com/user-attachments/assets/3874b57f-e71d-4450-9683-a38fb1930f61)

I get of corse only link for my user, however I can change username to carlos:
FROM:
https://0aee004303f56eca82a5ab1500d200ee.web-security-academy.net/forgot-password?user=wiener&token=856c956cfc27e74d04252e7b1b9136124cd2beee
TO: 
https://0aee004303f56eca82a5ab1500d200ee.web-security-academy.net/forgot-password?user=carlos&token=856c956cfc27e74d04252e7b1b9136124cd2beee



