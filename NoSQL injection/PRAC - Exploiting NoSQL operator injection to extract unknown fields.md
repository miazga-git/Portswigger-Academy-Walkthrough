`I didn't do that lab due to the limitation of Burpsuite community.`
`I tried second time with owasp zap but it looks like object user has only field:
0 id
1 username 
2 password
3 email
request about 4th field gives 500 error from app 
`

Title: Exploiting NoSQL operator injection to extract unknown fields
Level: PRACTITIONER
Desc:  The user lookup functionality for this lab is powered by a MongoDB NoSQL database. It is vulnerable to NoSQL injection.
To solve the lab, log in as carlos. 

# Walkthrough:
Field password accepts the $ne parameter.
<img width="1345" height="428" alt="image" src="https://github.com/user-attachments/assets/268062fd-c785-43e3-be19-375992db40e9" />

I try to add ned operator $where as a third field in POST request:

<img width="1344" height="475" alt="image" src="https://github.com/user-attachments/assets/dc331c31-eee1-41e1-8863-8e2c04286c81" />

I got different respone when I used $where: 1 . This indicates that the JavaScript in the $where clause is being evaluated.

I add `"Object.keys(this)[1].match('^.{}.*')"` to $where operator: 

<img width="1041" height="361" alt="image" src="https://github.com/user-attachments/assets/e47d08b9-697e-4b3b-b3d4-e700f6049d86" />

I modify payload to `"$where":"Object.keys(this)[1].match('^.{§§}§§.*')"` . 
The first identifies the character position number, and the second identifies the character itself

I make intruder attack with type cluster bomb to get parameter name of an object with index 1.
First list i number from 1 to 20 for example. 
Second is A-za-z0-9


After all I would get parameter name of the object. On index one we will have "username" name of field.
Proof: 
<img width="1353" height="333" alt="image" src="https://github.com/user-attachments/assets/4761bcc8-696b-4a9f-8243-abe567f04e86" />

After that, we can try to guess other field names incrementing id in Object.
`"$where":"Object.keys(this)[2].match('^.{§§}§§.*')"` . 

According to walkthrough from portswigger the second name of the filed indicates reset token.

Next step:
Try to sedn: `GET /forgot-password?YOURTOKENNAME=invalid`. Notice that you receive an Invalid token error message. This confirms that you have the correct token name and endpoint.

Last step:
Again in intruder, but now change values of $where operator to : `"$where":"this.YOURTOKENNAME.match('^.{§§}§§.*')"`
Now we don't try to guess parameter names of Object, now we try to guess values of parameter YOURTOKENNAME in object.

Final request: `GET /forgot-password?YOURTOKENNAME=TOKENVALUE`





