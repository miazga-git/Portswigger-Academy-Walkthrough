Title: Exploiting NoSQL injection to extract data
Desc: The user lookup functionality for this lab is powered by a MongoDB NoSQL database. It is vulnerable to NoSQL injection.
To solve the lab, extract the password for the administrator user, then log in to their account.
You can log in to your own account using the following credentials: wiener:peter. 
Level: PRACTITIONER


# Theory: 
Consider a vulnerable application that allows users to look up other registered usernames and displays their role. This triggers a request to the URL:
`https://insecure-website.com/user/lookup?username=admin`

This results in the following NoSQL query of the users collection:
`{"$where":"this.username == 'admin'"}`

As the query uses the $where operator, you can attempt to inject JavaScript functions into this query so that it returns sensitive data. For example, you could send the following payload:
`admin' && this.password[0] == 'a' || 'a'=='b`

This returns the first character of the user's password string, enabling you to extract the password character by character.

You could also use the JavaScript match() function to extract information. For example, the following payload enables you to identify whether the password contains digits:
`admin' && this.password.match(/\d/) || 'a'=='b`


# Walkthrough:
During authentication I can see the lookup request: 
<img width="1210" height="279" alt="image" src="https://github.com/user-attachments/assets/60c94855-30bb-4b85-9feb-a7a50d1b1553" />

I added this string to the request and used url encoding:
`admin' && this.password[0] == 'a' || 'a'=='b`

I get response, that "Could not find user.
I try with password for my user and I try to use first letter, which I know.
<img width="1195" height="325" alt="image" src="https://github.com/user-attachments/assets/5cb97ecf-837c-4ebb-b9b6-e42b9bd4576d" />

It works.

Now I can do this for administrator account. I used intruder for that.

<img width="486" height="145" alt="image" src="https://github.com/user-attachments/assets/0e2d8438-e78b-447a-b334-48055c2e7d0e" />







