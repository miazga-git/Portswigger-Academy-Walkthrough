Title: Performing CSRF exploits over GraphQL
Level: PRACTITIONER
Desc:  The user management functions for this lab are powered by a GraphQL endpoint. The endpoint accepts requests with a content-type of x-www-form-urlencoded and is therefore vulnerable to cross-site request forgery (CSRF) attacks.
To solve the lab, craft some HTML that uses a CSRF attack to change the viewer's email address, then upload it to your exploit server.
You can log in to your own account using the following credentials: wiener:peter.
Learn more about Working with GraphQL in Burp Suite. 


# Walkthrough:
Convert the request into a POST request with a Content-Type of x-www-form-urlencoded. To do this, right-click the request and select Change request method twice. 
<img width="730" height="702" alt="image" src="https://github.com/user-attachments/assets/3cae7e72-647a-4177-babd-ccb1c9ab1872" />

Encode body with URL encoding:
<img width="863" height="271" alt="image" src="https://github.com/user-attachments/assets/fde642a8-f472-4fbf-bb42-52a9f3eec022" />

Jak skonstruowac body to requestu x-www-form-urlencoded:
1. Bierzesz oryginalny request
<img width="665" height="568" alt="image" src="https://github.com/user-attachments/assets/2356eb82-8d77-46df-b1e7-a3a5620ea5cf" />
2. Przechodzisz do zak≈Çadki Graphql:
<img width="614" height="580" alt="image" src="https://github.com/user-attachments/assets/598f7820-3497-428b-9c49-6d5ba45ea3ca" />
3. Bierzesz query i variables i robisz:
  query=SKOPIUJ_ZAWARTOSC_QUERY&variables=SKOPIUJ_ZAWARTOSC_VARIABLES
4. URL ENCODE, ale nie enkoduj query= ani znaku & ani variables=
<img width="1247" height="540" alt="image" src="https://github.com/user-attachments/assets/54a2b834-e451-4ee0-8674-da7736d1991d" />

Right click on request->Engagement tools->create CSRG

But if you are poor(like me :))) ):


